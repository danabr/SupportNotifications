<!DOCTYPE html>
<html>
  <head>
    <title>Zendesk Tickets</title>
    <link rel="stylesheet" type="text/css" href="css/master_password.css"/>
    <script type="text/javascript">
      function initForm() {
        var bg = chrome.extension.getBackgroundPage();
        var form = document.getElementById("password_form");
        var errorElement = document.getElementById("error");
        form.onsubmit = function() {
          if (form.master_password.value.length < 6) {
            errorElement.innerHTML = "Password to short";
          } else if (bg.loadConfig(form.master_password.value)) {
            chrome.browserAction.setPopup({popup: "popup.html"});
            chrome.browserAction.setBadgeBackgroundColor({color: [123, 170, 30, 255] });
            window.close();
          } else {
            errorElement.innerHTML = "Incorrect password";
          }
          return false;
        }
        form.master_password.focus();
      }
    </script>
  </head>
  <body onload="initForm()">
    <form id="password_form">
      <label for="master_password">Master password:</label><br/>
      <input type="password" name="master_password" id="master_password"></input>
      <input type="submit" name="submit_button" value="OK" />
      <p id="error"></p>
    </form>
  </body>
</html>